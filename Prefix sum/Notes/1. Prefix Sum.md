## 1. Definition / Idea

Prefix Sum (cumulative sum) is a technique to efficiently answer range sum queries by precomputing cumulative sums up to each index. Instead of recalculating sums for every query, we can compute them in O(1) time after O(n) preprocessing.

## 2. Key Properties

- Precompute cumulative sums into a separate array.
    
- Range sum `[l, r]` can be answered as `prefix[r] - prefix[l-1]`.
    
- Works for both 1D arrays and 2D matrices.
    

## 3. Steps / Working

1. Initialize `prefix[0] = nums[0]`.
    
2. For each index `i`, compute `prefix[i] = prefix[i-1] + nums[i]`.
    
3. Answer queries using prefix differences.
    

## 4. Example (Python) â€“ Immutable Range Sum Query

```python
class NumArray:
    def __init__(self, nums):
        self.prefix = [0] * (len(nums) + 1)
        for i in range(len(nums)):
            self.prefix[i+1] = self.prefix[i] + nums[i]

    def sumRange(self, left, right):
        return self.prefix[right+1] - self.prefix[left]
```

## 5. Use Cases

- Range sum queries.
    
- Range updates.
    
- Dynamic programming.
    
- Subarray counting problems.
    

## 6. Variations / Related Concepts

- Running sum.
    
- Inclusive / Exclusive prefix sums.
    
- Range updates using difference arrays.
    
- 2D prefix sums.
    

## 7. Common Mistakes & Pitfalls

- Off-by-one errors in indexing.
    
- Inconsistent 0-based vs 1-based indexing.
    
- Forgetting to initialize prefix correctly.
    
- Misunderstanding problem constraints.
    
- Not considering edge cases (empty, negatives, single element).
    

## 8. Complexity Analysis

- **1D Prefix Sum**
    
    - Preprocessing: O(n), Space O(n)
        
    - Query: O(1)
        
- **2D Prefix Sum**
    
    - Preprocessing: O(n_m), Space O(n_m)
        
    - Query: O(1)
        
- **Range Updates**
    
    - Preprocessing: O(n), Space O(n)
        
    - Query: O(1)
        

## 9. Applications of Prefix Sum

- Computing subarray sums.
    
- Efficient range updates and queries.
    
- Running averages.
    
- Counting occurrences.
    
- Dynamic programming optimization.